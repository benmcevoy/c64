#importonce
#import "Config.asm"

.const STRIDE = 5
.const VOICE_NUMBER_OF_BEATS = 0
.const VOICE_ROTATION = 1
.const VOICE_TRANSPOSE = 2
.const VOICE_INSTRUMENT = 3
.const VOICE_TTL = 4

/* **************** SONG DATA **************** */
.align $100 
osc1_pattern:       .byte 1, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, $ff
.align $100 
osc2_pattern:       .byte 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 0, 4, 0, 0, 8, 3, 4, 0, 0, 8, 3, 6, 0, 0, 8, 3, 1, 0, 0, 8, 3, 0, 0, 0, 8, 5, 2, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, 5, 5, 0, 0, 8, $ff
.align $100 
osc3_pattern:       .byte 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 0, 5, 0, 0, 8, 1, 6, 0, 0, 8, 1, 1, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 1, 5, 0, 0, 8, 2, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, $ff
.align $100 
accent1_pattern:    .byte 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 1, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 2, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 4, 7, 0, 0, 8, 3, 7, 0, 0, 8, 3, 1, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 8, 0, 0, 8, 3, 2, 0, 0, 8, 3, 2, 0, 0, 8, $ff
.align $100 
accent2_pattern:    .byte 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 2, 1, 0, 0, 8, 2, 3, 0, 0, 8, 2, 6, 0, 0, 8, 3, 8, 0, 0, 8, 4, 2, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 4, 3, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 8, 0, 0, 8, 3, 8, 0, 0, 8, 3, 2, 0, 0, 8, 3, 2, 0, 0, 8, $ff
.align $100 
accent3_pattern:    .byte 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 1, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 2, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 8, 0, 0, 8, 3, 8, 0, 0, 8, 3, 8, 0, 0, 8, 3, 2, 0, 0, 8, 3, 3, 0, 0, 8, $ff
.align $100 
chord_pattern:      .byte 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, 1, 1, 0, 0, 8, $ff
.align $100 
tempo_pattern:      .byte 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, 5, 0, 0, 0, 8, $ff
.align $100 
filter_pattern:     .byte 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 0, 0, 0, 0, 8, 1, 0, 0, 0, 8, 1, 2, 0, 0, 8, 1, 4, 0, 0, 8, 1, 4, 0, 0, 8, 1, 4, 0, 0, 8, 1, 4, 0, 0, 8, 1, 4, 0, 0, 8, 3, 2, 0, 0, 8, 2, 3, 0, 0, 8, 2, 3, 0, 0, 8, 2, 3, 0, 0, 8, 2, 3, 0, 0, 8, 2, 3, 0, 0, 8, 2, 3, 0, 0, 8, 3, 3, 0, 0, 8, 3, 3, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 3, 1, 0, 0, 8, 4, 1, 0, 0, 8, 4, 2, 0, 0, 8, 4, 3, 0, 0, 8, 4, 4, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 4, 5, 0, 0, 8, 5, 5, 0, 0, 8, 7, 5, 0, 0, 8, 6, 5, 0, 0, 8, 5, 6, 0, 0, 8, 5, 8, 0, 0, 8, 5, 2, 0, 0, 8, 5, 3, 0, 0, 8, 3, 2, 0, 0, 8, 3, 8, 0, 0, 8, 3, 6, 0, 0, 8, 3, 4, 0, 0, 8, 3, 7, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 3, 5, 0, 0, 8, 4, 5, 0, 0, 8, 5, 5, 0, 0, 8, 6, 6, 0, 0, 8, 6, 7, 0, 0, 8, 5, 7, 0, 0, 8, 5, 7, 0, 0, 8, 5, 7, 0, 0, 8, 5, 7, 0, 0, 8, 5, 7, 0, 0, 8, 5, 7, 0, 0, 8, 5, 7, 0, 0, 8, $ff


/* **************** Macros **************** */
.macro ReadSong() {
    Next(OSCILLATOR1, osc1_pattern)
    Next(OSCILLATOR2, osc2_pattern)
    Next(OSCILLATOR3, osc3_pattern)
    Next(FILTER, filter_pattern)
    Next(ACCENT1, accent1_pattern)
    Next(ACCENT2, accent2_pattern)
    Next(ACCENT3, accent3_pattern)
    Next(CHORD, chord_pattern)
    Next(TEMPO, tempo_pattern)    

    dec _voicePatternTTL + OSCILLATOR1
    dec _voicePatternTTL + OSCILLATOR2
    dec _voicePatternTTL + OSCILLATOR3
    dec _voicePatternTTL + FILTER
    dec _voicePatternTTL + ACCENT1
    dec _voicePatternTTL + ACCENT2    
    dec _voicePatternTTL + ACCENT3
    dec _voicePatternTTL + CHORD
    dec _voicePatternTTL + TEMPO
}

.macro Next(voiceNumber, pattern) {
    ldy #voiceNumber
    lda _voicePatternIndex, Y
    tax
    lda pattern, X
    cmp #$FF
    bne !+
        lda #0
        sta _voicePatternIndex, Y
    !:

    ldx _voicePatternTTL, Y
    bne !+
        SetState(pattern)
    !:
}

.macro SetIndex(parameter) {
    lda _voicePatternIndex, Y
    clc; adc #parameter
    tax
}

.macro SetState(pattern) { 
    SetIndex(VOICE_NUMBER_OF_BEATS)
    lda pattern, X
    sta _voiceNumberOfBeats,Y

    SetIndex(VOICE_ROTATION)
    lda pattern, X
    sta _voiceRotation,Y
    
    SetIndex(VOICE_TTL)
    lda pattern, X
    sta _voicePatternTTL,Y

    lda _voicePatternIndex, Y
    clc; adc #STRIDE
    sta _voicePatternIndex, Y
}
